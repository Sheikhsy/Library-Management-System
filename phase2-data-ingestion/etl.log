2025-08-01 18:08:37,837 [ERROR] root: Database creation failed: (pymysql.err.OperationalError) (1049, "Unknown database 'lb_management_system'")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3295, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 626, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\_auth.py", line 241, in caching_sha2_password_auth
    pkt = conn._read_packet()
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1049, "Unknown database 'lb_management_system'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\phase2-data-ingestion\data_processor.py", line 60, in ensure_database_exists
    with temp_engine.connect() as conn:
         ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3271, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2434, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3295, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 626, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\connections.py", line 361, in __init__
    self.connect()
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\connections.py", line 669, in connect
    self._request_authentication()
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\connections.py", line 979, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\_auth.py", line 241, in caching_sha2_password_auth
    pkt = conn._read_packet()
          ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\.venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1049, "Unknown database 'lb_management_system'")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-01 18:17:21,347 [INFO] root: Ensured database `lb_management_system` exists.
2025-08-01 18:17:21,792 [WARNING] Library1: File csv_data\library.csv not found – skipping
2025-08-01 18:17:21,807 [WARNING] Book: File csv_data\book.csv not found – skipping
2025-08-01 18:17:21,807 [WARNING] Author: File csv_data\author.csv not found – skipping
2025-08-01 18:17:21,807 [WARNING] Member: File csv_data\member.csv not found – skipping
2025-08-01 18:17:21,807 [INFO] root: === ETL SUMMARY ===
2025-08-01 18:17:21,807 [INFO] root: libraries  : inserted=0   skipped=0   invalid=0  
2025-08-01 18:17:21,807 [INFO] root: books      : inserted=0   skipped=0   invalid=0  
2025-08-01 18:17:21,807 [INFO] root: authors    : inserted=0   skipped=0   invalid=0  
2025-08-01 18:17:21,807 [INFO] root: members    : inserted=0   skipped=0   invalid=0  
2025-08-01 18:18:40,303 [INFO] root: Ensured database `lb_management_system` exists.
2025-08-01 18:18:40,317 [WARNING] Library1: File /.csv_data\library.csv not found – skipping
2025-08-01 18:18:40,317 [WARNING] Book: File /.csv_data\book.csv not found – skipping
2025-08-01 18:18:40,317 [WARNING] Author: File /.csv_data\author.csv not found – skipping
2025-08-01 18:18:40,317 [WARNING] Member: File /.csv_data\member.csv not found – skipping
2025-08-01 18:18:40,317 [INFO] root: === ETL SUMMARY ===
2025-08-01 18:18:40,317 [INFO] root: libraries  : inserted=0   skipped=0   invalid=0  
2025-08-01 18:18:40,317 [INFO] root: books      : inserted=0   skipped=0   invalid=0  
2025-08-01 18:18:40,317 [INFO] root: authors    : inserted=0   skipped=0   invalid=0  
2025-08-01 18:18:40,317 [INFO] root: members    : inserted=0   skipped=0   invalid=0  
2025-08-01 18:22:15,062 [INFO] root: Ensured database `lb_management_system` exists.
2025-08-01 18:22:15,105 [WARNING] Library1: File C:\.csv_data\libraries.csv not found – skipping
2025-08-01 18:22:15,105 [WARNING] Book: File C:\.csv_data\books.csv not found – skipping
2025-08-01 18:22:15,105 [WARNING] Author: File C:\.csv_data\authors.csv not found – skipping
2025-08-01 18:22:15,105 [WARNING] Member: File C:\.csv_data\members.csv not found – skipping
2025-08-01 18:22:15,105 [INFO] root: === ETL SUMMARY ===
2025-08-01 18:22:15,105 [INFO] root: libraries  : inserted=0   skipped=0   invalid=0  
2025-08-01 18:22:15,105 [INFO] root: books      : inserted=0   skipped=0   invalid=0  
2025-08-01 18:22:15,105 [INFO] root: authors    : inserted=0   skipped=0   invalid=0  
2025-08-01 18:22:15,105 [INFO] root: members    : inserted=0   skipped=0   invalid=0  
2025-08-01 18:23:09,051 [INFO] root: Ensured database `lb_management_system` exists.
2025-08-01 18:23:09,091 [WARNING] Library1: File C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\phase2-data-ingestion\csv_data\libraries.csv not found – skipping
2025-08-01 18:23:09,091 [WARNING] Book: File C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\phase2-data-ingestion\csv_data\books.csv not found – skipping
2025-08-01 18:23:09,091 [WARNING] Author: Invalid row {'author_id': '1', 'first_name': 'George', 'last_name': 'Orwell', 'birth_date': '1903-06-25', 'nationality': 'British', 'biography': "Known for '1984' and 'Animal Farm'"}: 1 validation error for Author
email
  Field required [type=missing, input_value={'author_id': '1', 'first...984' and 'Animal Farm'"}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-08-01 18:23:09,091 [WARNING] Author: Invalid row {'author_id': '2', 'first_name': 'Jane', 'last_name': 'Austen', 'birth_date': '1775-12-16', 'nationality': 'British', 'biography': "English novelist known for 'Pride and Prejudice'"}: 1 validation error for Author
email
  Field required [type=missing, input_value={'author_id': '2', 'first... 'Pride and Prejudice'"}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-08-01 18:23:09,091 [WARNING] Author: Invalid row {'author_id': '3', 'first_name': 'Mark', 'last_name': 'Twain', 'birth_date': '1835-11-30', 'nationality': 'American', 'biography': "Famous for 'Adventures of Huckleberry Finn'"}: 1 validation error for Author
email
  Field required [type=missing, input_value={'author_id': '3', 'first...s of Huckleberry Finn'"}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-08-01 18:23:09,091 [WARNING] Author: Invalid row {'author_id': '4', 'first_name': 'Agatha', 'last_name': 'Christie', 'birth_date': 'invalid-date', 'nationality': 'British', 'biography': 'Queen of Mystery; wrote over 60 detective novels'}: 1 validation error for Author
email
  Field required [type=missing, input_value={'author_id': '4', 'first...er 60 detective novels'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-08-01 18:23:09,091 [WARNING] Author: Invalid row {'author_id': '5', 'first_name': 'Haruki', 'last_name': 'Murakami', 'birth_date': '1949-01-12', 'nationality': 'Japanese', 'biography': 'Blends magical realism with themes of loneliness'}: 1 validation error for Author
email
  Field required [type=missing, input_value={'author_id': '5', 'first...h themes of loneliness'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-08-01 18:23:09,091 [INFO] Author: Inserted=0 skipped=0 invalid=5
2025-08-01 18:23:09,091 [WARNING] Member: File C:\Users\MasudShaikh\Documents\Qtx_Intern\Qtx-Task1\SQL\Assignments\Assignments\library-management-system\phase2-data-ingestion\csv_data\members.csv not found – skipping
2025-08-01 18:23:09,091 [INFO] root: === ETL SUMMARY ===
2025-08-01 18:23:09,091 [INFO] root: libraries  : inserted=0   skipped=0   invalid=0  
2025-08-01 18:23:09,091 [INFO] root: books      : inserted=0   skipped=0   invalid=0  
2025-08-01 18:23:09,091 [INFO] root: authors    : inserted=0   skipped=0   invalid=5  
2025-08-01 18:23:09,091 [INFO] root: members    : inserted=0   skipped=0   invalid=0  
